<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Livestock Tycoon</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }
    h1 {
      color: #2c3e50;
    }
    .section {
      background: white;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    button {
      margin-top: 10px;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background: #3498db;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #2980b9;
    }
    select, input[type=text], input[type=range] {
      padding: 8px;
      margin-top: 5px;
      width: 100%;
    }
    label span {
      font-weight: bold;
      display: inline-block;
      margin-top: 10px;
    }
    img {
      max-width: 100px;
      display: block;
      margin-top: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #eaeaea;
    }
  </style>
</head>
<body>
  <h1>Livestock Tycoon</h1>

  <div class="section">
    <label>Farm Name:</label>
    <input type="text" id="farmName">
    <label>Student Name:</label>
    <input type="text" id="studentName">
  </div>

  <div class="section">
    <label><span>Choose an Animal:</span></label>
    <select id="animal" onchange="updateAnimalImage()">
      <option value="pig">Pig</option>
      <option value="steer">Steer</option>
      <option value="lamb">Lamb</option>
    </select>
    <img id="animalImage" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Young_pig.jpg/320px-Young_pig.jpg" alt="Animal">

    <label><span>Set Animal Purchase Price ($100–$400):</span></label>
    <input type="range" id="animalPrice" min="100" max="400" value="150" oninput="document.getElementById('animalPriceVal').innerText = this.value">
    <span>Price: $<span id="animalPriceVal">150</span></span>

    <label><span>Set Feed Cost ($10–100):</span></label>
    <input type="range" id="feedCost" min="10" max="100" value="20" oninput="document.getElementById('feedCostVal').innerText = this.value">
    <span>Feed Cost: $<span id="feedCostVal">20</span></span>

    <label><span>Choose Feed Type:</span></label>
    <select id="feedType">
      <option value="corn">Corn</option>
      <option value="alfalfa">Alfalfa</option>
      <option value="soy">Soy Meal</option>
    </select>

    <label><span>Choose a Buyer:</span></label>
    <select id="buyer">
      <option value="auction">Auction House (variable)</option>
      <option value="packer">Packer (stable)</option>
      <option value="direct">Direct-to-Consumer (high for quality)</option>
    </select>

    <button onclick="finishYear()">Finish Year</button>
    <audio id="soundEffect" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>
  </div>

  <div class="section">
    <h2>Results:</h2>
    <p id="result"></p>
  </div>

  <div class="section">
    <h2>Leaderboard</h2>
    <table id="leaderboard">
      <thead>
        <tr>
          <th>Name</th>
          <th>Farm</th>
          <th>Animal</th>
          <th>Feed</th>
          <th>Buyer</th>
          <th>Year</th>
          <th>Profit</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="leaderboardBody"></tbody>
    </table>
  </div>

  <script>
    const animalImages = {
      pig: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Young_pig.jpg/320px-Young_pig.jpg",
      steer: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Cow_female_black_white.jpg/320px-Cow_female_black_white.jpg",
      lamb: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Sheep_and_lamb.jpg/320px-Sheep_and_lamb.jpg",
    };

    const basePrice = { pig: 300, steer: 600, lamb: 200 };
    const feedTypeEffect = { corn: 1.0, alfalfa: 1.1, soy: 1.2 };
    const buyerEffect = {
      auction: () => 0.8 + Math.random() * 0.6,
      packer: () => 1.0,
      direct: () => 1.5
    };

    let year = 1;
    let totalProfit = 0;

    function updateAnimalImage() {
      const animal = document.getElementById("animal").value;
      document.getElementById("animalImage").src = animalImages[animal];
    }

    function getWeatherEffect() {
      const weather = ["sunny", "rainy", "drought", "storm"];
      const selected = weather[Math.floor(Math.random() * weather.length)];
      if (selected === "drought") return 0.8;
      if (selected === "storm") return 0.9;
      return 1.0;
    }

    function getHealthEffect() {
      return 0.8 + Math.random() * 0.4; // 0.8–1.2
    }

    function finishYear() {
      const name = document.getElementById('studentName').value.trim();
      const farm = document.getElementById('farmName').value.trim();
      if (!name || !farm) return alert("Please enter your name and farm name.");

      const animal = document.getElementById('animal').value;
      const price = parseInt(document.getElementById('animalPrice').value);
      const feedCost = parseInt(document.getElementById('feedCost').value);
      const buyer = document.getElementById('buyer').value;
      const feedType = document.getElementById('feedType').value;

      document.getElementById("soundEffect").play();

      let feedQuality = 0.5 + (feedCost / 100);
      feedQuality *= feedTypeEffect[feedType];
      let quality = basePrice[animal] * feedQuality;

      // Apply external effects
      quality *= getWeatherEffect();
      quality *= getHealthEffect();

      if (buyer === "direct" && feedQuality < 1) quality *= 0.7;

      const revenue = quality * buyerEffect[buyer]();
      const cost = price + feedCost;
      const profit = Math.round(revenue - cost);
      totalProfit += profit;

      document.getElementById('result').innerText = `Year ${year}: You made $${Math.round(revenue)} in sales, spent $${cost}, and profit is $${profit}. Total after ${year} year(s): $${totalProfit}`;

      const row = document.createElement('tr');
      row.innerHTML = `<td>${name}</td><td>${farm}</td><td>${animal}</td><td>${feedType}</td><td>${buyer}</td><td>${year}</td><td>$${profit}</td><td>$${totalProfit}</td>`;
      document.getElementById("leaderboardBody").appendChild(row);

      localStorage.setItem("livestockLeaderboard", document.getElementById("leaderboardBody").innerHTML);
      localStorage.setItem("livestockTotalProfit" + name + farm, totalProfit);

      year++;
      if (year > 5) {
        alert("Game over! Total profit after 5 years: $" + totalProfit);
        year = 1;
        totalProfit = 0;
      }
    }

    window.onload = function() {
      const saved = localStorage.getItem("livestockLeaderboard");
      if (saved) document.getElementById("leaderboardBody").innerHTML = saved;
    };
  </script>
</body>
</html>
